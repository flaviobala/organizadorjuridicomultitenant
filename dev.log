
> sistema-juridico@0.1.0 dev
> next dev --turbopack

 ⚠ Port 3000 is in use by process 13608, using available port 3002 instead.
   ▲ Next.js 15.4.1 (Turbopack)
   - Local:        http://localhost:3002
   - Network:      http://192.168.2.20:3002
   - Environments: .env.local, .env

 ✓ Starting...
 ✓ Ready in 1870ms
 ○ Compiling / ...
 ✓ Compiled / in 3.7s
 GET / 200 in 4168ms
 ○ Compiling /login ...
 GET /favicon.ico?favicon.45db1c09.ico 200 in 658ms
 ✓ Compiled /login in 706ms
 GET /login 200 in 857ms
 ✓ Compiled /api/auth/login in 422ms
🔍 DEBUG LOGIN - Dados recebidos: { email: 'flavioha@gmail.com', password: '21957@123' }
✅ Validação passou, tentando login...
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."password", "public"."users"."name", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."email" = $1 AND 1=1) LIMIT $2 OFFSET $3
📊 Resultado do login: {
  success: false,
  message: 'Email ou senha incorretos',
  hasUser: false,
  hasToken: false
}
 POST /api/auth/login 401 in 997ms
🔍 DEBUG LOGIN - Dados recebidos: { email: 'flavioha@gmail.com', password: '123456' }
✅ Validação passou, tentando login...
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."password", "public"."users"."name", "public"."users"."created_at", "public"."users"."updated_at" FROM "public"."users" WHERE ("public"."users"."email" = $1 AND 1=1) LIMIT $2 OFFSET $3
📊 Resultado do login: {
  success: true,
  message: 'Login realizado com sucesso',
  hasUser: true,
  hasToken: true
}
 POST /api/auth/login 200 in 374ms
 ✓ Compiled /dashboard in 419ms
 GET /dashboard 200 in 480ms
 ✓ Compiled /api/projects in 169ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at", COALESCE("aggr_selection_0_Document"."_aggr_count_documents", 0) AS "_aggr_count_documents" FROM "public"."projects" LEFT JOIN (SELECT "public"."documents"."project_id", COUNT(*) AS "_aggr_count_documents" FROM "public"."documents" WHERE 1=1 GROUP BY "public"."documents"."project_id") AS "aggr_selection_0_Document" ON ("public"."projects"."id" = "aggr_selection_0_Document"."project_id") WHERE "public"."projects"."user_id" = $1 ORDER BY "public"."projects"."created_at" DESC OFFSET $2
prisma:query SELECT "public"."documents"."id", "public"."documents"."document_type", "public"."documents"."status", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1,$2) OFFSET $3
 GET /api/projects 200 in 266ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at", COALESCE("aggr_selection_0_Document"."_aggr_count_documents", 0) AS "_aggr_count_documents" FROM "public"."projects" LEFT JOIN (SELECT "public"."documents"."project_id", COUNT(*) AS "_aggr_count_documents" FROM "public"."documents" WHERE 1=1 GROUP BY "public"."documents"."project_id") AS "aggr_selection_0_Document" ON ("public"."projects"."id" = "aggr_selection_0_Document"."project_id") WHERE "public"."projects"."user_id" = $1 ORDER BY "public"."projects"."created_at" DESC OFFSET $2
prisma:query SELECT "public"."documents"."id", "public"."documents"."document_type", "public"."documents"."status", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1,$2) OFFSET $3
 GET /api/projects 200 in 112ms
 ✓ Compiled /api/usage in 208ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."api_usage"."id", "public"."api_usage"."user_id", "public"."api_usage"."service", "public"."api_usage"."operation", "public"."api_usage"."model", "public"."api_usage"."tokens_input", "public"."api_usage"."tokens_output", "public"."api_usage"."tokens_total", "public"."api_usage"."cost_brl", "public"."api_usage"."method", "public"."api_usage"."success", "public"."api_usage"."error_message", "public"."api_usage"."document_id", "public"."api_usage"."project_id", "public"."api_usage"."date", "public"."api_usage"."created_at" FROM "public"."api_usage" WHERE ("public"."api_usage"."user_id" = $1 AND "public"."api_usage"."date" >= $2 AND "public"."api_usage"."date" <= $3) ORDER BY "public"."api_usage"."date" DESC OFFSET $4
 GET /api/usage 200 in 283ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."api_usage"."id", "public"."api_usage"."user_id", "public"."api_usage"."service", "public"."api_usage"."operation", "public"."api_usage"."model", "public"."api_usage"."tokens_input", "public"."api_usage"."tokens_output", "public"."api_usage"."tokens_total", "public"."api_usage"."cost_brl", "public"."api_usage"."method", "public"."api_usage"."success", "public"."api_usage"."error_message", "public"."api_usage"."document_id", "public"."api_usage"."project_id", "public"."api_usage"."date", "public"."api_usage"."created_at" FROM "public"."api_usage" WHERE ("public"."api_usage"."user_id" = $1 AND "public"."api_usage"."date" >= $2 AND "public"."api_usage"."date" <= $3) ORDER BY "public"."api_usage"."date" DESC OFFSET $4
 GET /api/usage 200 in 57ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."api_usage"."id", "public"."api_usage"."user_id", "public"."api_usage"."service", "public"."api_usage"."operation", "public"."api_usage"."model", "public"."api_usage"."tokens_input", "public"."api_usage"."tokens_output", "public"."api_usage"."tokens_total", "public"."api_usage"."cost_brl", "public"."api_usage"."method", "public"."api_usage"."success", "public"."api_usage"."error_message", "public"."api_usage"."document_id", "public"."api_usage"."project_id", "public"."api_usage"."date", "public"."api_usage"."created_at" FROM "public"."api_usage" WHERE ("public"."api_usage"."user_id" = $1 AND "public"."api_usage"."date" >= $2 AND "public"."api_usage"."date" <= $3) ORDER BY "public"."api_usage"."date" DESC OFFSET $4
 GET /api/usage 200 in 64ms
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."api_usage"."id", "public"."api_usage"."user_id", "public"."api_usage"."service", "public"."api_usage"."operation", "public"."api_usage"."model", "public"."api_usage"."tokens_input", "public"."api_usage"."tokens_output", "public"."api_usage"."tokens_total", "public"."api_usage"."cost_brl", "public"."api_usage"."method", "public"."api_usage"."success", "public"."api_usage"."error_message", "public"."api_usage"."document_id", "public"."api_usage"."project_id", "public"."api_usage"."date", "public"."api_usage"."created_at" FROM "public"."api_usage" WHERE ("public"."api_usage"."user_id" = $1 AND "public"."api_usage"."date" >= $2 AND "public"."api_usage"."date" <= $3) ORDER BY "public"."api_usage"."date" DESC OFFSET $4
 GET /api/usage 200 in 76ms
 ✓ Compiled /projects/[id]/upload in 353ms
 GET /projects/3/upload 200 in 1091ms
 ✓ Compiled /api/projects/[id] in 214ms
🚀 BUSCA DE PROJETO INICIADA
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
Buscando projeto: 3 para usuário: 2
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE ("public"."projects"."id" = $1 AND "public"."projects"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."documents"."id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."is_personal_document", "public"."documents"."created_at", "public"."documents"."updated_at", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1) ORDER BY "public"."documents"."document_number" ASC OFFSET $2
prisma:query SELECT "public"."document_validations"."id", "public"."document_validations"."is_relevant", "public"."document_validations"."relevance_score", "public"."document_validations"."ai_analysis", "public"."document_validations"."suggestions", "public"."document_validations"."status", "public"."document_validations"."reviewed_at", "public"."document_validations"."document_id" FROM "public"."document_validations" WHERE "public"."document_validations"."document_id" IN ($1,$2) OFFSET $3
✅ Projeto encontrado: { id: 3, name: 'Flavio Henrique', documentCount: 2 }
 GET /api/projects/3 200 in 933ms
🚀 BUSCA DE PROJETO INICIADA
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
Buscando projeto: 3 para usuário: 2
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE ("public"."projects"."id" = $1 AND "public"."projects"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."documents"."id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."is_personal_document", "public"."documents"."created_at", "public"."documents"."updated_at", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1) ORDER BY "public"."documents"."document_number" ASC OFFSET $2
prisma:query SELECT "public"."document_validations"."id", "public"."document_validations"."is_relevant", "public"."document_validations"."relevance_score", "public"."document_validations"."ai_analysis", "public"."document_validations"."suggestions", "public"."document_validations"."status", "public"."document_validations"."reviewed_at", "public"."document_validations"."document_id" FROM "public"."document_validations" WHERE "public"."document_validations"."document_id" IN ($1,$2) OFFSET $3
✅ Projeto encontrado: { id: 3, name: 'Flavio Henrique', documentCount: 2 }
 GET /api/projects/3 200 in 112ms
 ○ Compiling /api/documents/[id]/rotate ...
 ✓ Compiled /api/documents/[id]/rotate in 963ms
prisma:query SELECT 1
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 42 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '69',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:15 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '85',
      'x-kong-proxy-latency': '23',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf'
  }
}
 POST /api/documents/42/rotate 500 in 2488ms
 GET /projects/3/upload 200 in 168ms
🚀 BUSCA DE PROJETO INICIADA
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
Buscando projeto: 3 para usuário: 2
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE ("public"."projects"."id" = $1 AND "public"."projects"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."documents"."id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."is_personal_document", "public"."documents"."created_at", "public"."documents"."updated_at", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1) ORDER BY "public"."documents"."document_number" ASC OFFSET $2
prisma:query SELECT "public"."document_validations"."id", "public"."document_validations"."is_relevant", "public"."document_validations"."relevance_score", "public"."document_validations"."ai_analysis", "public"."document_validations"."suggestions", "public"."document_validations"."status", "public"."document_validations"."reviewed_at", "public"."document_validations"."document_id" FROM "public"."document_validations" WHERE "public"."document_validations"."document_id" IN ($1,$2) OFFSET $3
✅ Projeto encontrado: { id: 3, name: 'Flavio Henrique', documentCount: 2 }
 GET /api/projects/3 200 in 178ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 356ms
prisma:query SELECT 1
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 42 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '69',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:32 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '8',
      'x-kong-proxy-latency': '7',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf'
  }
}
 POST /api/documents/42/rotate 500 in 129ms
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 43 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '97',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:40 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '45',
      'x-kong-proxy-latency': '34',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf'
  }
}
 POST /api/documents/43/rotate 500 in 164ms
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 43 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '97',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:43 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '8',
      'x-kong-proxy-latency': '8',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf'
  }
}
 POST /api/documents/43/rotate 500 in 125ms
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 43 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '97',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:47 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '6',
      'x-kong-proxy-latency': '10',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/07%20c%C3%B3digo%20fonte.pdf'
  }
}
 POST /api/documents/43/rotate 500 in 102ms
 GET /projects/3/upload 200 in 137ms
🚀 BUSCA DE PROJETO INICIADA
prisma:query SELECT 1
prisma:query SELECT "public"."users"."id", "public"."users"."email", "public"."users"."name" FROM "public"."users" WHERE ("public"."users"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
Buscando projeto: 3 para usuário: 2
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE ("public"."projects"."id" = $1 AND "public"."projects"."user_id" = $2) LIMIT $3 OFFSET $4
prisma:query SELECT "public"."documents"."id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."is_personal_document", "public"."documents"."created_at", "public"."documents"."updated_at", "public"."documents"."project_id" FROM "public"."documents" WHERE "public"."documents"."project_id" IN ($1) ORDER BY "public"."documents"."document_number" ASC OFFSET $2
prisma:query SELECT "public"."document_validations"."id", "public"."document_validations"."is_relevant", "public"."document_validations"."relevance_score", "public"."document_validations"."ai_analysis", "public"."document_validations"."suggestions", "public"."document_validations"."status", "public"."document_validations"."reviewed_at", "public"."document_validations"."document_id" FROM "public"."document_validations" WHERE "public"."document_validations"."document_id" IN ($1,$2) OFFSET $3
✅ Projeto encontrado: { id: 3, name: 'Flavio Henrique', documentCount: 2 }
 GET /api/projects/3 200 in 121ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 326ms
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 42 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '69',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:21:58 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '14',
      'x-kong-proxy-latency': '6',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf'
  }
}
 POST /api/documents/42/rotate 500 in 122ms
prisma:query SELECT "public"."documents"."id", "public"."documents"."project_id", "public"."documents"."user_id", "public"."documents"."original_filename", "public"."documents"."stored_filename", "public"."documents"."smart_filename", "public"."documents"."document_type", "public"."documents"."detected_document_type", "public"."documents"."document_number", "public"."documents"."mime_type", "public"."documents"."original_size_bytes", "public"."documents"."is_personal_document", "public"."documents"."is_grouped", "public"."documents"."grouped_at", "public"."documents"."status", "public"."documents"."pdf_path", "public"."documents"."ocr_text", "public"."documents"."pdf_size_bytes", "public"."documents"."page_count", "public"."documents"."page_size", "public"."documents"."ai_analysis", "public"."documents"."analysis_confidence", "public"."documents"."created_at", "public"."documents"."updated_at" FROM "public"."documents" WHERE ("public"."documents"."id" = $1 AND 1=1) LIMIT $2 OFFSET $3
prisma:query SELECT "public"."projects"."id", "public"."projects"."user_id", "public"."projects"."name", "public"."projects"."client", "public"."projects"."system", "public"."projects"."action_type", "public"."projects"."narrative", "public"."projects"."processed_narrative", "public"."projects"."status", "public"."projects"."created_at", "public"."projects"."updated_at" FROM "public"."projects" WHERE "public"."projects"."id" IN ($1) OFFSET $2
🔄 Rotacionando documento 42 em 90°...
❌ Erro ao baixar PDF: Error [StorageUnknownError]: {"url":"http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf"}
    at <unknown> (../../../src/lib/fetch.ts:39:11)
    at Generator.next (<anonymous>) {
  __isStorageError: true,
  originalError: Response {
    status: 400,
    statusText: 'Bad Request',
    headers: Headers {
      'content-type': 'application/json; charset=utf-8',
      'content-length': '69',
      connection: 'keep-alive',
      date: 'Sun, 26 Oct 2025 17:22:00 GMT',
      'access-control-allow-origin': '*',
      'x-kong-upstream-latency': '11',
      'x-kong-proxy-latency': '2',
      via: 'kong/2.8.1'
    },
    body: undefined,
    bodyUsed: false,
    ok: false,
    redirected: false,
    type: 'default',
    url: 'http://127.0.0.1:54321/storage/v1/object/documents/processed/Outros_Documentos_QUE_285964_576123_1.pdf'
  }
}
 POST /api/documents/42/rotate 500 in 110ms
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "Foi forçado o cancelamento de uma conexão existente pelo host remoto." }) }
